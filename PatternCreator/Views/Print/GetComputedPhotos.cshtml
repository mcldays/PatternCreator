@using System.Drawing
@using Newtonsoft.Json
@using PatternCreator.Models
@using PatternCreator.Utilities
@model List<DocumentPrintViewModel>
@{

}
@foreach (var models in Model.GroupBy(t => t.Identity))
{

    using (UserContext db = new UserContext())
    {
        var docs = models.ToArray();
        int index = 0;
        int parts = Convert.ToInt32(Math.Ceiling(Convert.ToDouble(docs.Length) / 4));
        switch (models.Key)
        {
            case DocumentPrintViewModel.TypeDoc.WorkIdentity:

                for (int i = 0; i < parts; i++)
                {

                    <div class='photo-wrap substrated' style="@(ViewBag.Substrate!=true?"":"display: none;")height: 424px; width:248px">
                        <div class="@(ViewBag.Substrate!=true?"printdocument":"") notsubstrate" style="transform: scale(0.33, 0.33); transform-origin: 0 0;">
                            <table style="height: 24.5cm; width: 19.38cm; page-break-after: always; border-collapse: collapse; margin-left: auto; margin-right: auto; margin-top: 10px">
                                <tbody>
                                    @{
                                        index = (i * 4); 
                                        int[] ids = new int[4];
                                    }
                                    @for (int step = 0; step < 4; step++)
                                    {
                                        <tr style="height: 6.24cm;">
                                            <td style="width: 50%; border: 1px dotted black;">
                                                <table style="border-collapse: collapse; border:none">
                                                    <thead>
                                                        <tr style="height: 0.36cm">
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.67cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.69cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.5cm"></th>
                                                            <th style="width: 0.64cm">

                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr style="height: 0.36cm">
                                                            @{
                                                                DocumentModel doc = null;
                                                                if (index < docs.Length)
                                                                {
                                                                    doc = db.DocumentModels.Find(docs[index].DocId);
                                                                    ids[step] = docs[index].DocId;
                                                                }
                                                            }
                                                            <td style="font-size: 8pt; font-family: Times New Roman; text-align: center; font-weight: bold; border-bottom: 1px solid black" colspan="22">
                                                                @(doc?.Organization.OrganizationName)
                                                            </td>
                                                            <td></td>
                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td style="font-size: 6pt; font-family: Times New Roman; text-align: center; vertical-align: top !important;" colspan="22">
                                                                (наименование организации)
                                                            </td>
                                                            <td></td>
                                                        </tr>
                                                    <tr style="height: 0.36cm">
                                                        <td colspan="8" rowspan="9" style="font-family: Times New Roman; vertical-align: top !important; padding:2px !important"><div style="width: 3cm; height: 4cm; margin-left: auto; margin-right: auto; text-align: center; vertical-align: middle"><img src="@Url.Action("GetUserPhoto","Pattern",new{id=doc?.UserId})" width="100%" /></div></td>
                                                        <td style="font-size: 9pt; font-family: Times New Roman; text-align: center; font-weight: bold; vertical-align: top !important;" colspan="9">
                                                            УДОСТОВЕРЕНИЕ №
                                                        </td>
                                                        <td style="font-size: 9pt; font-family: Times New Roman; text-align: center; font-weight: bold; vertical-align: top !important; border-bottom: 1px solid black" colspan="3">
                                                            @(doc?.DocumentId)
                                                        </td>
                                                        <td colspan="3"></td>
                                                    </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td colspan="15"></td>
                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: center; padding-right: 0.5cm; font-weight: bold;" colspan="14">@(doc?.UserModel.Surname)</td>
                                                            <td></td>
                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td colspan="15"></td>
                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: center; padding-right: 0.5cm; font-weight: bold;" colspan="14">@($"{doc?.UserModel.Name} {doc?.UserModel.Patronymic}")</td>
                                                            <td></td>
                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td colspan="15"></td>
                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td style="border-bottom: 1px solid black" colspan="14"></td>
                                                            <td></td>
                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td style="font-size: 6pt; font-family: Times New Roman; text-align: center; vertical-align: top !important" colspan="14">(личная подпись)</td>
                                                            <td></td>
                                                        </tr>
                                                        <tr style="height: 0.72cm">
                                                            <td colspan="15"></td>
                                                        </tr>
                                                        <tr style="height: 0.67cm">
                                                            <td></td>
                                                            <td colspan="22" style="font-size: 9pt; font-family: Times New Roman; text-align: left;">Прошел курсы подготовки кадров по профессии:</td>
                                                        </tr>
                                                        <tr style="height: 0.79cm">
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: center; border-bottom: 1px solid black;" colspan="21">@(doc?.SpecialtyModel.SpecialityName)</td>
                                                            <td style="border-bottom: 1px solid black;"></td>
                                                            <td></td>
                                                        </tr>
                                                        <tr style="height: 0.59cm">
                                                            <td colspan="23"></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                            <td style="width: 50%; border: 1px dotted black; padding: 0 !important">
                                                <table style="border-collapse: collapse; border:none">
                                                    <thead>
                                                        <tr style="height: 0.36cm">
                                                            <th style="width: 0.49cm"></th>
                                                            <th style="width: 0.52cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.81cm"></th>
                                                            <th style="width: 0.57cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.39cm"></th>
                                                            <th style="width: 0.27cm"></th>
                                                            <th style="width: 0.34cm"></th>
                                                            <th style="width: 0.32cm"></th>
                                                            <th style="width: 0.27cm"></th>
                                                            <th style="width: 0.34cm"></th>
                                                            <th style="width: 0.3cm"></th>
                                                            <th style="width: 0.54cm"></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr style="height: 0.36cm">
                                                            <td></td>
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: center; font-weight: bold; vertical-align: bottom !important;" colspan="22">
                                                                Решением квалификационной комиссии
                                                            </td>

                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td colspan="23"></td>
                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td></td>
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: center; vertical-align: bottom !important; border-bottom: 1px solid black;" colspan="22">
                                                                @($"{doc?.UserModel.Surname_DativeCase} {doc?.UserModel.Name_DativeCase} {doc?.UserModel.Patronymic_DativeCase}")
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td colspan="23" style="font-size: 6pt; font-family: Times New Roman; text-align: center; vertical-align: top !important">(фамилия, имя, отчество)</td>
                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td></td>
                                                            <td colspan="8" style="font-size: 8pt; font-family: Times New Roman;">Присвоена квалификация</td>
                                                            @{
                                                                var specialty = ComputePhoto.TrimWrapping(doc?.SpecialtyModel.SpecialityName, 2, 35);
                                                            }
                                                            <td colspan="14" style="font-size: 10pt; font-family: Times New Roman; border-bottom: 1px solid black; vertical-align: bottom !important">@(specialty[0])</td>
                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td></td>
                                                            <td colspan="22" style="font-size: 10pt; font-family: Times New Roman; border-bottom: 1px solid black; vertical-align: bottom !important">@(specialty[1])</td>
                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td></td>
                                                            <td colspan="22" style="font-size: 10pt; font-family: Times New Roman; border-bottom: 1px solid black; vertical-align: bottom !important">@(doc?.SpecialtyModel.Quality)</td>
                                                        </tr>
                                                        <tr style="height: 1.11cm">
                                                            <td></td>
                                                            <td colspan="22" style="font-size: 7pt; font-family: Times New Roman; text-align: center; vertical-align: middle !important">@(doc?.SpecialtyModel.FieldSpecialty)</td>
                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td colspan="23"></td>
                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td></td>
                                                            <td colspan="22" style="font-size: 8pt; font-family: Times New Roman;">Основание:</td>
                                                        </tr>
                                                        <tr style="height: 0.67cm">
                                                            <td></td>
                                                            <td colspan="22" style="font-size: 9pt; font-family: Times New Roman; text-align: left; border-bottom: 1px solid black; vertical-align: bottom !important">@($"Протокол № {doc?.ProtocolName}{(doc?.SpecialtyModel.Prefix.Length > 0 ? "-" + (doc?.SpecialtyModel.Prefix) : "")} от «{doc?.Date.Day}» {DateConverter.GetMounthName(doc?.Date.Month ?? 0)} {doc?.Date.Year} г.")</td>
                                                        </tr>
                                                        <tr style="height: 0.79cm">
                                                            <td></td>
                                                            <td colspan="9" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important">Председатель комиссии</td>
                                                            <td colspan="5" style="border-bottom: 1px solid black;"></td>
                                                            <td colspan="8" style="font-size: 9pt; font-family: Times New Roman; text-align: left; border-bottom: 1px solid black; vertical-align: bottom !important">А.В. Васильков</td>
                                                        </tr>
                                                        <tr style="height: 0.59cm">
                                                            <td colspan="11"></td>
                                                            <td colspan="3" style="font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top !important">(подпись)</td>
                                                            <td colspan="3" style="font-size: 6pt; font-family: Times New Roman; text-align: right; vertical-align: top !important">М.П.</td>
                                                            <td colspan="6" style="font-size: 6pt; font-family: Times New Roman; text-align: center;"></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                        </tr>
                                        index++;
                                    }


                                </tbody>
                            </table>
                        </div>
                        <img class='photo-delete' data-docs="@(JsonConvert.SerializeObject(ids))" src='../Resourses/svg/delete-white.svg' />
                    </div>
                }

                break;
            case DocumentPrintViewModel.TypeDoc.Ptm:

                for (int i = 0; i < parts; i++)
                {
                    <div class='photo-wrap substrated' style="@(ViewBag.Substrate!=true?"":"display: none;") height: 464px; width:248px">
                        <div class="@(ViewBag.Substrate!=true?"printdocument":"") notsubstrate" style="transform: scale(0.33, 0.33); transform-origin: 0 0;">
                            <table style="height: 24.5cm; width: 19.38cm; page-break-after: always; border-collapse: collapse; margin-left: auto; margin-right: auto; margin-top: 10px">
                                <tbody>
                                    @{index = (i * 4); int[] ids = new int[4];}
                                    @for (int step = 0; step < 4; step++)
                                    {
                                        <tr>
                                            <td style="width: 50%; border: 1px dotted black;">
                                                <table style="border-collapse: collapse; border:none">
                                                    <thead>
                                                    <tr style="height: 0">
                                                        <th style="width: 0.25cm"></th>
                                                        <th style="width: 0.42cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.77cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.4cm"></th>
                                                        <th style="width: 0.34cm"></th>
                                                        <th style="width: 0.21cm"></th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr style="height: 0.4cm">
                                                            @{
                                                                DocumentModel doc = null;
                                                                if (index < docs.Length)
                                                                {
                                                                    doc = db.DocumentModels.Find(docs[index].DocId); ids[step] = docs[index].DocId;
                                                                }
                                                            }
                                                            <td rowspan="18"></td>
                                                            <td rowspan="6"></td>
                                                            <td style="border-bottom: 1px solid black" rowspan="2"></td>
                                                            <td rowspan="2" colspan="19" style="font-size: 8pt; font-family: Times New Roman; text-align: center; vertical-align: middle !important; border-bottom: 1px solid black">
                                                                @(doc?.Organization.OrganizationName)
                                                            </td>
                                                            <td style="border-bottom: 1px solid black" rowspan="2" colspan="2"></td>
                                                            <td rowspan="6"></td>
                                                            <td rowspan="18"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm"></tr>
                                                        <tr style="height: 0.4cm">
                                                            <td rowspan="2"></td>
                                                            <td rowspan="2" colspan="19" style="font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top !important;">
                                                                (наименование организации)
                                                            </td>
                                                            <td rowspan="2" colspan="2"></td>
                                                        </tr>
                                                        <tr style="height: 0.19cm"></tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="4"></td>
                                                            <td style="font-size: 8pt; font-family: Times New Roman; text-align: left; font-weight: bold; vertical-align: bottom !important;" colspan="8">
                                                                УДОСТОВЕРЕНИЕ №
                                                            </td>
                                                            <td style="font-size: 8pt; font-family: Times New Roman; text-align: center; font-weight: bold; vertical-align: bottom !important; border-bottom: 1px solid black" colspan="4">
                                                                @(doc?.DocumentId)
                                                            </td>
                                                            <td colspan="6"></td>
                                                        </tr>
                                                        <tr style="height: 0.19cm">
                                                            <td colspan="22"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="3" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">Выдано</td>
                                                            <td colspan="21" style="font-size: 9pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @($"{doc?.UserModel.Surname_DativeCase} {doc?.UserModel.Name_DativeCase} {doc?.UserModel.Patronymic_DativeCase}")
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="5" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">Место работы</td>
                                                            <td colspan="19" style="font-size: 9pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @(doc?.UserModel.CompanyModel.CompanyName)
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="4" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">Должность</td>
                                                            <td colspan="20" style="font-size: 9pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @(doc?.UserModel.Position)
                                                            </td>
                                                        </tr>
                                                        @{ var spec = ComputePhoto.TrimWrapping(doc?.SpecialtyModel.SpecialityName, 3, 66); }
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @(spec[0])
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @(spec[1])
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @(spec[2])
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top !important;">
                                                                (наименование программы по пожарно-техническому минимуму)
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="4" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                Протокол
                                                            </td>
                                                            <td colspan="4" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @($"№ {doc?.ProtocolName}{(doc?.SpecialtyModel.Prefix.Length > 0 ? "-" + (doc?.SpecialtyModel.Prefix) : "")}")
                                                            </td>
                                                            <td></td>
                                                            <td colspan="3" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                от
                                                            </td>
                                                            <td colspan="7" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @($"«{doc?.Date.Day}» {DateConverter.GetMounthName(doc?.Date.Month ?? 0)} {doc?.Date.Year} г.")
                                                            </td>
                                                            <td colspan="5"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="7" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                Действительно  до
                                                            </td>
                                                            <td colspan="8" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @($"«{doc?.Date.Day}» {DateConverter.GetMounthName(doc?.Date.Month ?? 0)} {doc?.Date.Year + doc?.SpecialtyModel.ValidUntil} г.")
                                                            </td>
                                                            <td colspan="9"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="9" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                Председатель комиссии
                                                            </td>
                                                            <td colspan="6" style="font-size: 8pt; font-family: Times New Roman; text-align: center; vertical-align: bottom !important; border-bottom: 1px solid black">Васильков А.В.</td>

                                                            <td colspan="9" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="11"></td>
                                                            <td colspan="2" style="font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top !important;">(Ф.И.О.)</td>
                                                            <td colspan="7"></td>
                                                            <td colspan="4" style="font-size: 5pt; font-family: Times New Roman; text-align: left; vertical-align: top !important;">(подпись)</td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="3"></td>
                                                            <td colspan="2" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: middle !important;">Дата</td>
                                                            <td></td>
                                                            <td colspan="13" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: middle !important;">@($"«{doc?.Date.Day}» {DateConverter.GetMounthName(doc?.Date.Month ?? 0)} {doc?.Date.Year} г.")</td>
                                                            <td colspan="5" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: middle !important;">М.П.</td>

                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                            <td style="width: 50%; border: 1px dotted black; padding: 0 !important">
                                                <table style="border-collapse: collapse; border:none">
                                                    <thead>
                                                        <tr style="height: 0">
                                                            <th style="width: 0.21cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                            <th style="width: 0.4cm"></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr style="height: 0.4cm">

                                                            <td rowspan="18"></td>
                                                            <td rowspan="4" colspan="3"></td>
                                                            <td rowspan="2" colspan="17" style="font-size: 8pt; font-family: Times New Roman; text-align: center; vertical-align: middle !important; border-bottom: 1px solid black">
                                                                Сведения о повторных проверках знаний пожарно-технического минимума
                                                            </td>
                                                            <td rowspan="4" colspan="4"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm"></tr>
                                                        <tr style="height: 0.4cm">
                                                            <td rowspan="2" colspan="17"></td>
                                                        </tr>
                                                        <tr style="height: 0.19cm"></tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="3" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">Выдано</td>
                                                            <td colspan="21" style="font-size: 9pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.19cm">
                                                            <td colspan="24"></td>
                                                        </tr>

                                                        <tr style="height: 0.4cm">
                                                            <td colspan="5" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">Место работы</td>
                                                            <td colspan="19" style="font-size: 9pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="4" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">Должность</td>
                                                            <td colspan="20" style="font-size: 9pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                Проведена проверка знаний пожарно-технического минимума
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 5pt; font-family: Times New Roman; text-align: left; vertical-align: top !important; border-bottom: 1px solid black">
                                                                (наименование программы по пожарно-техническому минимуму)
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top !important; border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="4" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                Протокол
                                                            </td>
                                                            <td colspan="4" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                            <td></td>
                                                            <td colspan="3" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                от
                                                            </td>
                                                            <td colspan="7" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                            <td colspan="5"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="7" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                Действительно  до
                                                            </td>
                                                            <td colspan="8" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                            <td colspan="9"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="9" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                Председатель комиссии
                                                            </td>
                                                            <td colspan="6" style="font-size: 8pt; font-family: Times New Roman; text-align: center; vertical-align: bottom !important; border-bottom: 1px solid black"></td>

                                                            <td colspan="9" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="11"></td>
                                                            <td colspan="2" style="font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top !important;">(Ф.И.О.)</td>
                                                            <td colspan="7"></td>
                                                            <td colspan="4" style="font-size: 5pt; font-family: Times New Roman; text-align: left; vertical-align: top !important;">(подпись)</td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="3"></td>
                                                            <td colspan="2" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: middle !important;">Дата</td>
                                                            <td></td>
                                                            <td colspan="13" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: middle !important;"></td>
                                                            <td colspan="5" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: middle !important;">М.П.</td>

                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                        </tr>
                                        index++;
                                    }


                                </tbody>
                            </table>
                        </div>
                        <img class='photo-delete' data-docs="@(JsonConvert.SerializeObject(ids))" src='../Resourses/svg/delete-white.svg' />
                    </div>
                }

                break;
            case DocumentPrintViewModel.TypeDoc.WorkHighSecurity:

                for (int i = 0; i < parts; i++)
                {
                    <div class='photo-wrap substrated' style="@(ViewBag.Substrate!=true?"":"display: none;")height: 424px; width:248px">
                        <div class="@(ViewBag.Substrate!=true?"printdocument":"") notsubstrate" style="transform: scale(0.33, 0.33); transform-origin: 0 0;">
                            <table style="height: 24.5cm; width: 19.38cm; page-break-after: always; border-collapse: collapse; margin-left: auto; margin-right: auto; margin-top: 10px">
                                <tbody>
                                    @{index = (i * 4); int[] ids = new int[4];}
                                    @for (int step = 0; step < 4; step++)
                                    {
                                        <tr>
                                            <td style="width: 50%; border: 1px dotted black;">
                                                <table style="border-collapse: collapse; border:none">
                                                    <thead>
                                                        <tr style="height: 0.35cm">
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.85cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.85cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.78cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr style="height: 0.35cm">
                                                            @{
                                                                DocumentModel doc = null;
                                                                if (index < docs.Length)
                                                                {
                                                                    doc = db.DocumentModels.Find(docs[index].DocId); ids[step] = docs[index].DocId;
                                                                }
                                                            }
                                                            <td style="font-size: 8pt; font-family: Times New Roman; text-align: center; font-weight: bold;" colspan="25">
                                                                @(doc?.Organization.OrganizationName)
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="25"></td>
                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td colspan="6"></td>
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left; font-weight: bold; vertical-align: top !important;" colspan="9">
                                                                УДОСТОВЕРЕНИЕ №
                                                            </td>
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left; font-weight: bold; vertical-align: top !important; border-bottom: 1px solid black" colspan="5">
                                                                @(doc?.DocumentId)
                                                            </td>
                                                            <td colspan="5"></td>
                                                        </tr>
                                                        <tr style="height: 0.25cm">
                                                            <td colspan="25"></td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="8" rowspan="12" style="font-size: 10pt; font-family: Times New Roman; vertical-align: top"><div style="width: 3cm; height: 4cm; margin-left: auto; margin-right: auto; border: 0px solid #333333; text-align: center; vertical-align: middle"><img src="@Url.Action("GetUserPhoto","Pattern",new{id=doc?.UserId})" width="100%" /></div></td>
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left;" colspan="4">Фамилия</td>
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left; border-bottom: 1px solid black" colspan="13">@(doc?.UserModel.Surname)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left;" colspan="2">Имя</td>
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left; border-bottom: 1px solid black" colspan="15">@(doc?.UserModel.Name)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left;" colspan="4">Отчество</td>
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left; border-bottom: 1px solid black" colspan="13">@(doc?.UserModel.Patronymic)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="font-size: 8pt; font-family: Times New Roman; text-align: center; vertical-align: bottom; border-bottom: 1px solid black" colspan="16" rowspan="2">@(doc?.UserModel.Position)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="border-bottom: 1px solid black; font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top;" colspan="17">(профессия, должность)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="font-size: 8pt; font-family: Times New Roman; text-align: center; vertical-align: bottom; border-bottom: 1px solid black" colspan="16" rowspan="2">@(doc?.UserModel.CompanyModel.CompanyName)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="border-bottom: 1px solid black; font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top;" colspan="17">(организация)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td rowspan="3" style="border-right: 1px solid black"></td>
                                                            <td style="border-top: 1px solid black; font-size: 9pt; font-family: Times New Roman; text-align: center;" colspan="16">Дата выдачи</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="border-bottom: 1px solid black; font-size: 9pt; font-family: Times New Roman; text-align: center;" colspan="16">@($"«{doc?.Date.Day}» {DateConverter.GetMounthName(doc?.Date.Month ?? 0)} {doc?.Date.Year} г.")</td>
                                                        </tr>
                                                        <tr style="height: 0.41cm">
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left;" colspan="16">Личная подпись</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                            <td style="width: 50%; border: 1px dotted black; padding: 0 !important">
                                                <table style="border-collapse: collapse; border:none">
                                                    <thead>
                                                        <tr style="height: 0">
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.75cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.43cm"></th>
                                                            <th style="width: 0.65cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.75cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr style="height: 0.35cm">
                                                            <td rowspan="17"></td>
                                                            <td style="font-size: 7pt; font-family: Times New Roman; text-align: left; " colspan="23">
                                                                Прошел(ла):
                                                            </td>
                                                            <td rowspan="17"></td>

                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="23" rowspan="2" style="font-size: 7pt; font-family: Times New Roman; text-align: left; vertical-align: top !important">- @(doc?.SpecialtyModel.SpecialityName);</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm"></tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="23" rowspan="3"></td>
                                                        </tr>
                                                        <tr style="height: 0.35cm"></tr>
                                                        <tr style="height: 0.35cm"></tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="23" style="font-size: 9pt; font-family: Times New Roman; text-align: center; font-weight: bold;">Решением аттестационной комиссии</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="23" rowspan="6" style="font-size: 7pt; font-family: Times New Roman; text-align: left; vertical-align: top !important">@(doc?.SpecialtyModel.FieldSpecialty)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm"></tr>
                                                        <tr style="height: 0.35cm"></tr>
                                                        <tr style="height: 0.35cm"></tr>
                                                        <tr style="height: 0.35cm"></tr>
                                                        <tr style="height: 0.35cm"></tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="7" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important">
                                                                <b>Основание: </b>Протокол
                                                            </td>
                                                            <td colspan="5" style="font-size: 8pt; font-family: Times New Roman; border-bottom: 1px solid black; text-align: left; vertical-align: bottom !important">@($"№ {doc?.ProtocolName}{(doc?.SpecialtyModel.Prefix.Length > 0 ? "-" + (doc?.SpecialtyModel.Prefix) : "")}")</td>
                                                            <td colspan="2" style="font-size: 8pt; font-family: Times New Roman; text-align: center; vertical-align: bottom !important">от</td>
                                                            <td colspan="9" style="font-size: 8pt; font-family: Times New Roman; border-bottom: 1px solid black; text-align: left; vertical-align: bottom !important">@($"«{doc?.Date.Day}» {DateConverter.GetMounthName(doc?.Date.Month ?? 0)} {doc?.Date.Year} г.")</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="23" style="font-size: 7pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important">Руководитель организации,</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="7" style="font-size: 7pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important">выдавшей удостоверение</td>
                                                            <td colspan="16" style="font-size: 9pt; font-family: Times New Roman; border-bottom: 1px solid black; text-align: right; vertical-align: bottom !important">Васильков А.В.</td>
                                                        </tr>
                                                        <tr style="height: 0.41cm">
                                                            <td colspan="12"></td>
                                                            <td colspan="2" style="font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top !important">(подпись)</td>
                                                            <td colspan="5"></td>
                                                            <td colspan="2" style="font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top !important">(Ф.И.О.)</td>
                                                            <td colspan="2"></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                        </tr>
                                        index++;
                                    }


                                </tbody>
                            </table>
                        </div>
                        <img class='photo-delete' data-docs="@(JsonConvert.SerializeObject(ids))" src='../Resourses/svg/delete-white.svg' />
                    </div>
                }

                break;
            case DocumentPrintViewModel.TypeDoc.WorkHighSecurityWithQuality:

                for (int i = 0; i < parts; i++)
                {
                    <div class='photo-wrap substrated' style="@(ViewBag.Substrate!=true?"":"display: none;")height: 424px; width:248px">
                        <div class="@(ViewBag.Substrate!=true?"printdocument":"") notsubstrate" style="transform: scale(0.33, 0.33); transform-origin: 0 0;">
                            <table style="height: 24.5cm; width: 19.38cm; page-break-after: always; border-collapse: collapse; margin-left: auto; margin-right: auto; margin-top: 10px">
                                <tbody>
                                    @{index = (i * 4); int[] ids = new int[4];}
                                    @for (int step = 0; step < 4; step++)
                                    {
                                        <tr>
                                            <td style="width: 50%; border: 1px dotted black;">
                                                <table style="border-collapse: collapse; border:none">
                                                    <thead>
                                                        <tr style="height: 0.35cm">
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.85cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.85cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.78cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                            <th style="width: 0.35cm"></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr style="height: 0.35cm">
                                                            @{
                                                                DocumentModel doc = null;
                                                                if (index < docs.Length)
                                                                {
                                                                    doc = db.DocumentModels.Find(docs[index].DocId); ids[step] = docs[index].DocId;
                                                                }
                                                            }
                                                            <td style="font-size: 8pt; font-family: Times New Roman; text-align: center; font-weight: bold;" colspan="25">
                                                                @(doc?.Organization.OrganizationName)
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="25"></td>
                                                        </tr>
                                                        <tr style="height: 0.36cm">
                                                            <td colspan="6"></td>
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left; font-weight: bold; vertical-align: top !important;" colspan="9">
                                                                УДОСТОВЕРЕНИЕ №
                                                            </td>
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left; font-weight: bold; vertical-align: top !important; border-bottom: 1px solid black" colspan="5">
                                                                @(doc?.DocumentId)
                                                            </td>
                                                            <td colspan="5"></td>
                                                        </tr>
                                                        <tr style="height: 0.25cm">
                                                            <td colspan="25"></td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="8" rowspan="12" style="font-size: 10pt; font-family: Times New Roman; vertical-align: top"><div style="width: 3cm; height: 4cm; margin-left: auto; margin-right: auto; border: 0px solid #333333; text-align: center; vertical-align: middle"><img src="@Url.Action("GetUserPhoto","Pattern",new{id=doc?.UserId})" width="100%" /></div></td>
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left;" colspan="4">Фамилия</td>
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left; border-bottom: 1px solid black" colspan="13">@(doc?.UserModel.Surname)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left;" colspan="2">Имя</td>
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left; border-bottom: 1px solid black" colspan="15">@(doc?.UserModel.Name)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left;" colspan="4">Отчество</td>
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left; border-bottom: 1px solid black" colspan="13">@(doc?.UserModel.Patronymic)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="font-size: 8pt; font-family: Times New Roman; text-align: center; vertical-align: bottom; border-bottom: 1px solid black" colspan="16" rowspan="2">@(doc?.UserModel.Position)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="border-bottom: 1px solid black; font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top;" colspan="17">(профессия, должность)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="font-size: 8pt; font-family: Times New Roman; text-align: center; vertical-align: bottom; border-bottom: 1px solid black" colspan="16" rowspan="2">@(doc?.UserModel.CompanyModel.CompanyName)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="border-bottom: 1px solid black; font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top;" colspan="17">(организация)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td rowspan="3" style="border-right: 1px solid black"></td>
                                                            <td style="border-top: 1px solid black; font-size: 9pt; font-family: Times New Roman; text-align: center;" colspan="16">Дата выдачи</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td style="border-bottom: 1px solid black; font-size: 9pt; font-family: Times New Roman; text-align: center;" colspan="16">@($"«{doc?.Date.Day}» {DateConverter.GetMounthName(doc?.Date.Month ?? 0)} {doc?.Date.Year} г.")</td>
                                                        </tr>
                                                        <tr style="height: 0.41cm">
                                                            <td style="font-size: 9pt; font-family: Times New Roman; text-align: left;" colspan="16">Личная подпись</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                            <td style="width: 50%; border: 1px dotted black; padding: 0 !important">
                                                <table style="border-collapse: collapse; border:none">
                                                    <thead>
                                                        <tr style="height: 0">
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.75cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.43cm"></th>
                                                            <th style="width: 0.65cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.75cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                            <th style="width: 0.33cm"></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr style="height: 0.35cm">
                                                            <td rowspan="17"></td>
                                                            <td style="font-size: 7pt; font-family: Times New Roman; text-align: left; " colspan="23">
                                                                Прошел(ла):
                                                            </td>
                                                            <td rowspan="17"></td>

                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="23" rowspan="2" style="font-size: 7pt; font-family: Times New Roman; text-align: left; vertical-align: top !important">- @(doc?.SpecialtyModel.SpecialityName);</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm"></tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="10" style="font-size: 7pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important">- стажировку продолжительностью</td>
                                                            <td colspan="13" style="font-size: 7pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">две смены</td>

                                                        </tr>
                                                    <tr style="height: 0.35cm">
                                                        <td colspan="10" style="font-size: 7pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important"></td>
                                                        <td colspan="13" style="font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top !important;">количество рабочих дней (смен)</td>
                                                    </tr>
                                                    <tr style="height: 0.35cm">
                                                        <td colspan="23"></td>
                                                    </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="23" style="font-size: 9pt; font-family: Times New Roman; text-align: center; font-weight: bold;">Решением аттестационной комиссии</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="23" rowspan="5" style="font-size: 7pt; font-family: Times New Roman; text-align: left; vertical-align: top !important">@(doc?.SpecialtyModel.FieldSpecialty)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm"></tr>
                                                        <tr style="height: 0.35cm"></tr>
                                                        <tr style="height: 0.35cm"></tr>
                                                        <tr style="height: 0.35cm"></tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="23" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: middle !important">Присвоена @(doc?.SpecialtyModel.Quality)</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="7" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important">
                                                                <b>Основание: </b>Протокол
                                                            </td>
                                                            <td colspan="5" style="font-size: 8pt; font-family: Times New Roman; vertical-align: bottom !important; border-bottom: 1px solid black; text-align: left;">@($"№ {doc?.ProtocolName}{(doc?.SpecialtyModel.Prefix.Length > 0 ? "-" + (doc?.SpecialtyModel.Prefix) : "")}")</td>
                                                            <td colspan="2" style="font-size: 8pt; font-family: Times New Roman; text-align: center; vertical-align: bottom !important">от</td>
                                                            <td colspan="9" style="font-size: 8pt; font-family: Times New Roman; border-bottom: 1px solid black; text-align: left; vertical-align: bottom !important">@($"«{doc?.Date.Day}» {DateConverter.GetMounthName(doc?.Date.Month ?? 0)} {doc?.Date.Year} г.")</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="23" style="font-size: 7pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important">Руководитель организации,</td>
                                                        </tr>
                                                        <tr style="height: 0.35cm">
                                                            <td colspan="7" style="font-size: 7pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important">выдавшей удостоверение</td>
                                                            <td colspan="16" style="font-size: 9pt; font-family: Times New Roman; border-bottom: 1px solid black; text-align: right; vertical-align: bottom !important">Васильков А.В.</td>
                                                        </tr>
                                                        <tr style="height: 0.41cm">
                                                            <td colspan="12"></td>
                                                            <td colspan="2" style="font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top !important">(подпись)</td>
                                                            <td colspan="5"></td>
                                                            <td colspan="2" style="font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top !important">(Ф.И.О.)</td>
                                                            <td colspan="2"></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                        </tr>
                                        index++;
                                    }


                                </tbody>
                            </table>
                        </div>
                        <img class='photo-delete' data-docs="@(JsonConvert.SerializeObject(ids))" src='../Resourses/svg/delete-white.svg' />
                    </div>
                }

                break;
            case DocumentPrintViewModel.TypeDoc.WorkSecurity:

                for (int i = 0; i < parts; i++)
                {
                    <div class='photo-wrap substrated' style="@(ViewBag.Substrate!=true?"":"display: none;")height: 490px; width:248px">
                        <div class="@(ViewBag.Substrate!=true?"printdocument":"") notsubstrate" style="transform: scale(0.33, 0.33); transform-origin: 0 0;">
                            <table style="height: 24.5cm; width: 19.38cm; page-break-after: always; border-collapse: collapse; margin-left: auto; margin-right: auto; margin-top: 10px">
                                <tbody>
                                    @{index = (i * 4); int[] ids = new int[4];}
                                    @for (int step = 0; step < 4; step++)
                                    {
                                        <tr>
                                            <td style="width: 50%; border: 1px dotted black;">
                                                <table style="border-collapse: collapse; border:none">
                                                    <thead>
                                                        <tr style="height: 0">
                                                            <th style="width: 0.34cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.48cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.57cm"></th>
                                                            <th style="width: 0.17cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr style="height: 0.4cm">
                                                            @{
                                                                DocumentModel doc = null;
                                                                if (index < docs.Length)
                                                                {
                                                                    doc = db.DocumentModels.Find(docs[index].DocId); ids[step] = docs[index].DocId;
                                                                }
                                                            }
                                                            <td rowspan="18"></td>
                                                            <td rowspan="5"></td>
                                                            <td style="border-bottom: 1px solid black" rowspan="2"></td>
                                                            <td rowspan="2" colspan="19" style="font-size: 8pt; font-family: Times New Roman; text-align: center; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @(doc?.Organization.OrganizationName)
                                                            </td>
                                                            <td style="border-bottom: 1px solid black" rowspan="2" colspan="2"></td>
                                                            <td rowspan="5"></td>
                                                            <td rowspan="18" colspan="2"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm"></tr>
                                                        <tr style="height: 0.4cm">
                                                            <td rowspan="3"></td>
                                                            <td rowspan="2" colspan="19" style="font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top !important;">
                                                                (наименование организации)
                                                            </td>
                                                            <td rowspan="3" colspan="2"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm"></tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="2"></td>
                                                            <td style="font-size: 8pt; font-family: Times New Roman; text-align: center; font-weight: bold; vertical-align: bottom !important;" colspan="9">
                                                                УДОСТОВЕРЕНИЕ №
                                                            </td>
                                                            <td style="font-size: 8pt; font-family: Times New Roman; text-align: center; font-weight: bold; vertical-align: bottom !important; border-bottom: 1px solid black" colspan="4">
                                                                @(doc?.DocumentId)
                                                            </td>
                                                            <td colspan="4"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="3" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">Выдано</td>
                                                            <td colspan="21" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @($"{doc?.UserModel.Surname_DativeCase} {doc?.UserModel.Name_DativeCase} {doc?.UserModel.Patronymic_DativeCase}")
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="5" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">Место работы</td>
                                                            <td colspan="19" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @(doc?.UserModel.CompanyModel.CompanyName)
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="4" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">Должность</td>
                                                            <td colspan="20" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @(doc?.UserModel.Position)
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                Проведена проверка  знаний требований  охраны труда  по программе
                                                            </td>
                                                        </tr>
                                                        @{ var spec = ComputePhoto.TrimWrapping(doc?.SpecialtyModel.SpecialityName, 5, 73); }
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @(spec[0])
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @(spec[1])
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @(spec[2])
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @(spec[3])
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @(spec[4])
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="4" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                Протокол
                                                            </td>
                                                            <td colspan="5" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @($"№ {doc?.ProtocolName}{(doc?.SpecialtyModel.Prefix.Length > 0 ? "-" + (doc?.SpecialtyModel.Prefix) : "")}")
                                                            </td>
                                                            <td colspan="15" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                заседания  комиссии  по  проверке  знаний
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="16" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                требований  охраны   труда   работников      от
                                                            </td>
                                                            <td colspan="8" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                @($"«{doc?.Date.Day}» {DateConverter.GetMounthName(doc?.Date.Month ?? 0)} {doc?.Date.Year} г.")
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="9" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                Председатель комиссии
                                                            </td>
                                                            <td colspan="8" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                            <td colspan="7" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">Васильков А.В.</td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="17"></td>
                                                            <td colspan="7" style="font-size: 5pt; font-family: Times New Roman; text-align: left; vertical-align: top !important;">(Ф.И.О., подпись)</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                            <td style="width: 50%; border: 1px dotted black; padding: 0 !important">
                                                <table style="border-collapse: collapse; border:none">
                                                    <thead>
                                                        <tr style="height: 0">
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.32cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                            <th style="width: 0.37cm"></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr style="height: 0.4cm">

                                                            <td rowspan="18"></td>
                                                            <td rowspan="3" colspan="3"></td>
                                                            <td rowspan="2" colspan="19" style="font-size: 8pt; font-family: Times New Roman; text-align: center; vertical-align: middle !important; border-bottom: 1px solid black">
                                                                Сведения о повторных проверках  знаний требований охраны труда
                                                            </td>
                                                            <td style="border-bottom: 1px solid black" rowspan="2" colspan="2"></td>
                                                            <td rowspan="3" colspan="2"></td>
                                                            <td rowspan="18" colspan="2"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm"></tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="19"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="3" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">Выдано</td>
                                                            <td colspan="21" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="10"></td>
                                                            <td colspan="14" style="font-size: 5pt; font-family: Times New Roman; text-align: left; vertical-align: top !important;">(Ф.И.О.)</td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="5" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">Место работы</td>
                                                            <td colspan="19" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="4" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">Должность</td>
                                                            <td colspan="20" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                Проведена проверка  знаний требований  охраны труда  по
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 5pt; font-family: Times New Roman; text-align: center; vertical-align: top !important; border-bottom: 1px solid black">
                                                                (наименование программы по охране труда)   (часов)
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="5" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                Протокол №
                                                            </td>
                                                            <td colspan="3" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                               
                                                            </td>
                                                            <td colspan="16" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                заседания  комиссии  по  проверке  знаний
                                                            </td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="15" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                требований охраны труда работников от
                                                            </td>
                                                            <td colspan="2" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">
                                                                «  »
                                                            </td>
                                                            <td colspan="4" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                            <td colspan="2" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black">20</td>
                                                            <td colspan="1" style="font-size: 8pt; font-family: Times New Roman; text-align: right; vertical-align: bottom !important; border-bottom: 1px solid black">г.</td>

                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="24" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="9" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important;">
                                                                Председатель комиссии
                                                            </td>
                                                            <td colspan="15" style="font-size: 8pt; font-family: Times New Roman; text-align: left; vertical-align: bottom !important; border-bottom: 1px solid black"></td>
                                                        </tr>
                                                        <tr style="height: 0.4cm">
                                                            <td colspan="17"></td>
                                                            <td colspan="7" style="font-size: 5pt; font-family: Times New Roman; text-align: left; vertical-align: top !important;">(Ф.И.О., подпись)</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </td>
                                        </tr>
                                        index++;
                                    }


                                </tbody>
                            </table>
                        </div>
                        <img class='photo-delete' data-docs="@(JsonConvert.SerializeObject(ids))" src='../Resourses/svg/delete-white.svg' />
                    </div>
                }

                break;
            case DocumentPrintViewModel.TypeDoc.Pplam:
                foreach (var model in models)
                {

                    var doc = db.DocumentModels.Find(model.DocId);


                    <div class="photo-wrap">
                        <div class="printdocument" style="transform: scale(0.6, 0.6); transform-origin: 0 0;">
                            <div style="flex-direction: column !important; white-space: pre; display: flex; height: 6.04cm; width: 9.11cm; line-height: 1.2 !important; border: 1px dotted black; font-family: Times New Roman !important; margin-top: 10px; margin-left: auto; margin-right:auto; padding: 0; padding: 0.4cm;">
                                <div style="display: flex; justify-content: center; font-size: 9pt; font-weight: bold;"><u>@(doc?.Organization.OrganizationName)</u></div>
                                <div style="display: flex; justify-content: center; font-size: 6pt; font-weight: normal;">(организация)</div>
                                <div style="display: flex; justify-content: center; font-size: 9pt !important; font-weight: bold;">УДОСТОВЕРЕНИЕ<span style="font-family: Times New Roman; font-weight: normal;"> № </span><span style="font-family: Times New Roman; font-weight: normal; text-decoration: underline"> @(doc?.DocumentId) </span></div>
                                <div style="display: flex; justify-content: center; font-size: 8pt; font-weight: normal;">
                                    <div style="align-items: center; display: flex;">Выдано о том, что</div>
                                    <div style="flex: 1;font-size: 10pt; font-weight: bold; text-align: center; vertical-align: bottom !important; border-bottom: 1px solid black">@($"{doc?.UserModel.Surname} {doc?.UserModel.Name} {doc?.UserModel.Patronymic}")</div>
                                </div>
                                <div style="font-size: 7pt; text-align: center; font-weight: normal;">(фамилия, имя, отчество)</div>
                                <div style="display: flex; justify-content: center; font-size: 8pt; font-weight: normal;">
                                    <div style="align-items: center; display: flex;">Место работы</div>
                                    <div style="flex: 1;font-size: 10pt; font-weight: bold; text-align: center; vertical-align: bottom !important; border-bottom: 1px solid black">@($"{doc?.UserModel.CompanyModel.CompanyName}")</div>
                                </div>
                                <div style="display: flex; justify-content: center; font-size: 8pt; font-weight: normal;">
                                    <div style="align-items: center; display: flex;">Должность(профессия)</div>
                                    <div style="flex: 1;font-size: 10pt; font-weight: bold; text-align: center; vertical-align: bottom !important; border-bottom: 1px solid black">@($"{doc?.UserModel.Position}")</div>
                                </div>
                                <div style="font-size: 8pt; white-space: normal; font-weight: bold; text-align: left; flex: 1; max-height:1.5cm">он (она) прошел(а) специальный @(doc?.EducationTime) часовой курс по<br />программе обучения @(doc?.SpecialtyModel.SpecialityName)<br />протокол № <u>@($"{doc?.ProtocolName}{(doc?.SpecialtyModel.Prefix.Length > 0 ? "-" + (doc?.SpecialtyModel.Prefix) : "")}")</u> от<span style="font-weight: normal">@($" «{doc?.Date.Day}» {DateConverter.GetMounthName(doc?.Date.Month ?? 0)} {doc?.Date.Year} г.")</span></div>
                                <div style="display: flex; justify-content: center; font-size: 8pt; font-weight: normal;">
                                    <div style="align-items: center; display: flex; font-weight: bold;">Председатель комиссии</div>
                                    <div style="flex: 1; font-size: 10pt; text-align: right; vertical-align: bottom !important; border-bottom: 1px solid black">А.В. Васильков</div>
                                </div>
                                <div style="display: flex; justify-content: center; font-size: 8pt; font-weight: normal; margin-top: 0.3cm;">
                                    <div style="flex: 1; font-size: 10pt; text-align: center; vertical-align: bottom !important; ">М.П.</div>
                                    <div style="flex: 1; font-size: 8pt; text-align: right; vertical-align: bottom !important; ">Действителен до</div>
                                    <div style="flex: 1; font-size: 8pt; text-align: center; vertical-align: bottom !important; border-bottom: 1px solid black">@($"«{doc?.Date.Day}» {DateConverter.GetMounthName(doc?.Date.Month ?? 0)} {doc?.Date.Year} г.")</div>
                                </div>
                            </div>
                            <div style="flex-direction: column !important; display: flex; page-break-after: always; height: 6.04cm; width: 9.11cm; line-height: 1.2 !important; border: 1px dotted black; font-family: Times New Roman !important; margin-top: 10px; margin-left: auto; margin-right:auto; padding: 0.4cm;">
                                <div style="display: flex; justify-content: center; font-size: 9pt; font-weight: bold;">
                                    <table style="width: 8.04cm; border: none; border-collapse: collapse;">
                                        <thead>
                                            <tr style="height: 0">
                                                <th style="width: 1.99cm"></th>
                                                <th style="width: 6.09cm"></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr style="height: 1.28cm">
                                                <td style="text-align: center; vertical-align: middle !important"><img src="../Resourses/Eagle.png" /></td>
                                                <td style="padding-left: 0.19cm !important; padding-right: 0.19cm">
                                                    <div style="display: flex; text-align: left; flex-direction: column; line-height: 1;">
                                                        <u style="font-size:12pt">@(doc?.Organization.OrganizationName)</u>
                                                        <span style="font-size: 6pt; font-weight: normal;">(наименование организации выдавшей удостоверение)</span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>

                                <div style="display: flex; justify-content: center; text-align: center; font-size: 15pt; font-weight: bold; margin-top: 0.6cm; margin-bottom: 0.6cm;">
                                    УДОСТОВЕРЕНИЕ
                                </div>
                                <div style="display: flex; justify-content: center; text-align: center; font-size: 8pt; line-height: 1; font-weight: bold; ">
                                    ОБУЧЕНИЕ ПО ОКАЗАНИЮ ПЕРВОЙ ПОМОЩИ ПОСТРАДАВШИМ НА ПРОИЗВОДСТВЕ
                                </div>
                            </div>                            
                        </div>
                        <img class='photo-delete' src='../Resourses/svg/delete-white.svg' />
                    </div>
                }

                break;
            case DocumentPrintViewModel.TypeDoc.Other:
                foreach (var model in models)
                {
                    <div class='photo-wrap'>
                        <div style="height: @(model.NaturalHeight/5)mm; display: block; width: @(model.NaturalWidth/5)mm;">

                            <img class="substrated" style="@(ViewBag.Substrate!=true?"display: none;":"")position: absolute; top: 0; left: 0;" width="100%" src="@Url.Action("GetPictureTemplate","Pattern", new{id=model.Image})" />

                            @foreach (var item in model.Items)
                            {
                                <span style="@(item.Underline?"text-decoration:underline;":""); text-underline-position: under; position: absolute; white-space: pre-line; font-family: Times New Roman; text-align: @(item.Format.FormatFlags==StringFormatFlags.MeasureTrailingSpaces?"justify":item.Format.Alignment == StringAlignment.Center ? "center" : (item.Format.Alignment == StringAlignment.Near ? "left" : "right")); top: @((item.Rectf.Y / 5).ToString().Replace(",", "."))px; left: @((item.Rectf.X/5).ToString().Replace(",", "."))px; font-size: @(item.FontSize/5)pt; font-weight: @(item.Weight == FontStyle.Regular ? "normal" : "bold"); width: @((item.Rectf.Width/5).ToString().Replace(",", "."))px; height: @((item.Rectf.Height/5).ToString().Replace(",", "."))px">@item.Text.Replace("*newline*", "\n")</span>
                            }
                            @foreach (var stamp in model.Stamps)
                            {
                                <img class="substrated" style="@(ViewBag.Substrate!=true?"display: none;":"")position: absolute; width: @((stamp.Rectf.Width/5).ToString().Replace(",", "."))px;height: @((stamp.Rectf.Height/5).ToString().Replace(",", "."))px; top: @((stamp.Rectf.Y / 5).ToString().Replace(",", "."))px; left: @((stamp.Rectf.X/5).ToString().Replace(",", "."))px;" src="data:image/png;base64, @stamp.Image" />
                            }
                            @foreach (var stamp in model.Photos)
                            {
                                <img style="position: absolute; width: @((stamp.Rectf.Width/5).ToString().Replace(",", "."))px; height: @((stamp.Rectf.Height/5).ToString().Replace(",", "."))px; top: @((stamp.Rectf.Y / 5).ToString().Replace(",", "."))px; left: @((stamp.Rectf.X/5).ToString().Replace(",", "."))px;" src="@Url.Action("GetUserPhoto","Pattern", new{id=stamp.UserId})" />
                            }
                        </div>
                        <div class="printdocument d-none">
                            <div style="height: @(model.NaturalHeight)mm; page-break-after: always; width: @(model.NaturalWidth)mm; margin-left:auto">

                                <img class="substrated" style="@(ViewBag.Substrate!=true?"display: none;":"")position: absolute; margin-top: 0; left: 0;" width="100%" src="@Url.Action("GetPictureTemplate","Pattern", new{id=model.Image})" />

                                @foreach (var item in model.Items)
                                {
                                    <span style="@(item.Underline?"text-decoration:underline;":""); text-underline-position: under; position: absolute; white-space: pre-line; font-family: Times New Roman; display: block; text-align: @(item.Format.FormatFlags==StringFormatFlags.MeasureTrailingSpaces?"justify":item.Format.Alignment == StringAlignment.Center ? "center" : (item.Format.Alignment == StringAlignment.Near ? "left" : "right")); margin-top: @(item.Rectf.Y.ToString().Replace(",", "."))px; margin-left: @(item.Rectf.X.ToString().Replace(",", "."))px; font-size: @(item.FontSize)pt; font-weight: @(item.Weight == FontStyle.Regular ? "normal" : "bold"); width: @(item.Rectf.Width.ToString().Replace(",", "."))px; height: @(item.Rectf.Height.ToString().Replace(",", "."))px">@(item.Text.Replace("*newline*", "\n"))</span>
                                }
                                @foreach (var stamp in model.Stamps)
                                {
                                    <img class="substrated" style="@(ViewBag.Substrate!=true?"display: none;":"")position: absolute; width: @((stamp.Rectf.Width).ToString().Replace(",", "."))px; height: @((stamp.Rectf.Height).ToString().Replace(",", "."))px; margin-top: @((stamp.Rectf.Y).ToString().Replace(",", "."))px;  margin-left: @((stamp.Rectf.X).ToString().Replace(",", "."))px;" src="data:image/png;base64, @stamp.Image" />
                                }
                                @foreach (var stamp in model.Photos)
                                {
                                    <img style="position: absolute; width: @((stamp.Rectf.Width).ToString().Replace(",", "."))px;height: @((stamp.Rectf.Height).ToString().Replace(",", "."))px; margin-top: @((stamp.Rectf.Y ).ToString().Replace(",", "."))px; margin-left: @((stamp.Rectf.X).ToString().Replace(",", "."))px;" src="@Url.Action("GetUserPhoto","Pattern", new{id=stamp.UserId})" />
                                }
                            </div>

                        </div>
                        <img class='photo-delete' src='../Resourses/svg/delete-white.svg' />
                    </div>
                                                                    }
                                                                    break;
                                                            }
                                                            if (models.Key == DocumentPrintViewModel.TypeDoc.WorkIdentity || models.Key == DocumentPrintViewModel.TypeDoc.Ptm || models.Key == DocumentPrintViewModel.TypeDoc.WorkSecurity)
                                                            {
                                                                foreach (var model in models)
                                                                {
                <div class='photo-wrap substrated' style="@(ViewBag.Substrate!=true?"display: none;":"")">
                    <div style="height: @(model.NaturalHeight/5)mm; display: block; width: @(model.NaturalWidth/5)mm;">

                        <img style="position: absolute; top: 0; left: 0;" width="100%" src="@Url.Action("GetPictureTemplate","Pattern", new{id=model.Image})" />

                        @foreach (var item in model.Items)
                        {
                            <span style="@(item.Underline?"text-decoration:underline;":"");text-underline-position: under; position: absolute; white-space: pre-line; font-family: Times New Roman; text-align: @(item.Format.FormatFlags==StringFormatFlags.MeasureTrailingSpaces?"justify":item.Format.Alignment == StringAlignment.Center ? "center" : (item.Format.Alignment == StringAlignment.Near ? "left" : "right")); top: @((item.Rectf.Y / 5).ToString().Replace(",", "."))px; left: @((item.Rectf.X/5).ToString().Replace(",", "."))px; font-size: @(item.FontSize/5)pt; font-weight: @(item.Weight == FontStyle.Regular ? "normal" : "bold"); width: @((item.Rectf.Width/5).ToString().Replace(",", "."))px; height: @((item.Rectf.Height/5).ToString().Replace(",", "."))px">@item.Text.Replace("*newline*", "\n")</span>
                        }
                        @foreach (var stamp in model.Stamps)
                        {
                            <img style="position: absolute; width: @((stamp.Rectf.Width/5).ToString().Replace(",", "."))px;height: @((stamp.Rectf.Height/5).ToString().Replace(",", "."))px; top: @((stamp.Rectf.Y / 5).ToString().Replace(",", "."))px; left: @((stamp.Rectf.X/5).ToString().Replace(",", "."))px;" src="data:image/png;base64, @stamp.Image" />
                        }
                        @foreach (var stamp in model.Photos)
                        {
                            <img style="position: absolute; width: @((stamp.Rectf.Width/5).ToString().Replace(",", "."))px; height: @((stamp.Rectf.Height/5).ToString().Replace(",", "."))px; top: @((stamp.Rectf.Y / 5).ToString().Replace(",", "."))px; left: @((stamp.Rectf.X/5).ToString().Replace(",", "."))px;" src="@Url.Action("GetUserPhoto","Pattern", new{id=stamp.UserId})" />
                        }
                    </div>
                    <div class="d-none @(ViewBag.Substrate!=true?"":"printdocument") onlysubstrate">
                        <div style="height: @(model.NaturalHeight)mm; width: @(model.NaturalWidth)mm; margin-left:auto">

                            <img style="position: absolute; margin-top: 0; left: 0;" width="100%" src="@Url.Action("GetPictureTemplate","Pattern", new{id=model.Image})" />

                            @foreach (var item in model.Items)
                            {
                                <span style="@(item.Underline?"text-decoration:underline;":"");text-underline-position: under; position: absolute; white-space: pre-line; font-family: Times New Roman; display: block; text-align: @(item.Format.FormatFlags==StringFormatFlags.MeasureTrailingSpaces?"justify":item.Format.Alignment == StringAlignment.Center ? "center" : (item.Format.Alignment == StringAlignment.Near ? "left" : "right")); margin-top: @(item.Rectf.Y.ToString().Replace(",", "."))px; margin-left: @(item.Rectf.X.ToString().Replace(",", "."))px; font-size: @(item.FontSize)pt; font-weight: @(item.Weight == FontStyle.Regular ? "normal" : "bold"); width: @(item.Rectf.Width.ToString().Replace(",", "."))px; height: @(item.Rectf.Height.ToString().Replace(",", "."))px">@(item.Text.Replace("*newline*", "\n"))</span>
                            }
                            @foreach (var stamp in model.Stamps)
                            {
                                <img style="position: absolute; width: @((stamp.Rectf.Width).ToString().Replace(",", "."))px; height: @((stamp.Rectf.Height).ToString().Replace(",", "."))px; margin-top: @((stamp.Rectf.Y).ToString().Replace(",", "."))px;  margin-left: @((stamp.Rectf.X).ToString().Replace(",", "."))px;" src="data:image/png;base64, @stamp.Image" />
                            }
                            @foreach (var stamp in model.Photos)
                            {
                                <img style="position: absolute; width: @((stamp.Rectf.Width).ToString().Replace(",", "."))px;height: @((stamp.Rectf.Height).ToString().Replace(",", "."))px; margin-top: @((stamp.Rectf.Y ).ToString().Replace(",", "."))px; margin-left: @((stamp.Rectf.X).ToString().Replace(",", "."))px;" src="@Url.Action("GetUserPhoto","Pattern", new{id=stamp.UserId})" />
                            }
                        </div>

                    </div>
                    <img class='photo-delete' data-id="@(model.DocId)" src='../Resourses/svg/delete-white.svg' />
                </div>
            }
        }
    }

}



